<p id="notice"><%= notice %></p>

<h1>Restaurants</h1>

<p> Search for a restaurant by name and location!</p>
<%= form_tag(restaurants_path, :method => "get", id: "search-form") do %>
<%= text_field_tag  :search, params[:search], placeholder: "Search Restaurants" %>
<%= submit_tag "Search" %>
<% end %>

<% if @restaurants.size > 0 %>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Location</th>
      <th>Votes for splitting</th>
      <th>Votes against splitting</th>
      <th>Splitting average</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
   
    <% @restaurants.each do |restaurant| %>
      <tr>
        <td><%= restaurant.name %></td>
        <td><%= restaurant.location %></td>
        <td><%= restaurant.votes_for_splitting || 0 %></td>
        <td><%= restaurant.votes_against_splitting || 0 %></td>
       <td><%= restaurant.votes.where(for_splitting: true).size %></td>
        <td><%= restaurant.votes.get_against_splitting_votes_for_restaurant(restaurant.id)%></td>
        <td><%= restaurant.votes.get_average_votes_for_restaurant(restaurant.id)%></td>
        <td><%= link_to 'Show', restaurant %></td>        
        <td><%= link_to 'View and Vote!', restaurant %></td>
        <td><%= link_to 'Edit', edit_restaurant_path(restaurant) %></td>
        
      </tr>
    <% end %>
   
  </tbody>
</table>
 
 
 
 <% end %>
<br>

<%= link_to 'New Restaurant', new_restaurant_path %>
